<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <title>Test Rough Create + Drag n' Drop</title>
  <!-- inali.dev - interact-->
  <style media="screen">
  :root {
    --color-obj: #0169B1;
    --color-obj-dropped: #8BBE42;
    --color-area: #86378B;
    --color-area-active: #D63A87;
    /* --color-: #F7D648; */
  }
  body {
    /* display: flex; */
    height: 100vh;
    width: 100vw;
    margin: 0;
  }
  .contenido {
    height: 100%;
    width: 100%;
  }
  .dropall {
    cursor: pointer;
    overflow: visible;
    position: fixed;
    height: 150px;
    width: 150px;
  }
  .dragall {
    position: fixed;
    height: 150px;
    width: 150px;
    z-index: 100;
    fill: var(--color-obj) !important;
  }
  #zonas_linguisticas {
    height: 100vh;
    width: 100vw;
    position: fixed;
    z-index: 1
  }
  #zonas_linguisticas svg path {
    height: 150px;
    width: 150px;
  }
  .drop-1 {
    top: 64px;
    left: 64px;
  }
  .drop-2 {
    top: 64px;
    right: 64px;
  }
  .drop-3 {
    bottom: 64px;
    left: 64px;
  }
  .drop-4 {
    bottom: 64px;
    right: 64px;
  }

  /*  */
  </style>
  <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
</head>
<body>
  <div class="contenedores">

    <!-- circulo -->
    <svg id="svg-circulo-area" class="drop-1 dropall" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet"
    viewBox="178.6385542168675 77.43373493975895 357.0120481927711 357.01204819277126" width="353.01" height="353.01">
    <defs>
      <path
      d="M532.65 254.94C532.65 352.36 453.56 431.45 356.14 431.45C258.73 431.45 179.64 352.36 179.64 254.94C179.64 157.52 258.73 78.43 356.14 78.43C453.56 78.43 532.65 157.52 532.65 254.94Z"
      id="circulo-area"></path>
    </defs>
    <g>
      <g>
        <use xlink:href="#circulo-area" opacity="1" fill="#651e48" fill-opacity="1"></use>
      </g>
    </g>
  </svg>

  <!-- cuadrado -->
  <svg id="svg-cuadrado-area" class="drop-2 dropall" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  preserveAspectRatio="xMidYMid meet"
  viewBox="111.1686746987952 78.63855421686739 387.13253012048193 383.51807228915663" >
  <defs>
    <path d="M112.17 79.64L495.3 79.64L495.3 459.16L112.17 459.16L112.17 79.64Z" id="cuadrado-area"></path>
  </defs>
  <g>
    <g>
      <use xlink:href="#cuadrado-area" opacity="1" fill="#1d5299" fill-opacity="1"></use>
      <g>
        <use xlink:href="#cuadrado-area" opacity="1" fill-opacity="0" stroke="#6c40d2" stroke-width="0"
        stroke-opacity="1"></use>
      </g>
    </g>
  </g>
</svg>
<!-- ireglular -->
<svg id="svg-irregular-area" class="drop-3 dropall" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
preserveAspectRatio="xMidYMid meet"
viewBox="206.34939759036146 65.38554216867462 270.26506024096386 293.15662650602405" width="266.27" height="289.16">
<defs>
  <path d="M473.61 66.39L437.47 172.41L433.86 219.4L324.22 239.88L403.73 272.41L349.52 285.66L339.88 342.29L282.05 304.94L274.82 355.54L236.27 300.12L207.35 219.4L232.65 133.86L473.61 66.39Z" id="irregular-area"></path>
</defs>
<g>
  <g>
    <use xlink:href="#irregular-area" opacity="1" fill="#b06508" fill-opacity="1"></use>
    <g>
      <use xlink:href="#irregular-area" opacity="1" fill-opacity="0" stroke="#000000" stroke-width="0"
      stroke-opacity="1"></use>
    </g>
  </g>
</g>
</svg>

<!-- triangulo -->

<svg id="svg-triangulo-area" class="drop-4 dropall" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
preserveAspectRatio="xMidYMid meet"
viewBox="179.84337349397592 85.86746987951798 249.78313253012053 294.3614457831326" width="245.78" height="290.36">
<defs>
  <path width="200" height="200" d="M426.63 374.82L180.84 377.23L300.12 86.87L426.63 374.82Z" id="triangulo-area"></path>
</defs>
<g>
  <g>
    <use xlink:href="#triangulo-area" opacity="1" fill="#469216" fill-opacity="1"></use>
    <g>
      <use xlink:href="#triangulo-area" opacity="1" fill-opacity="0" stroke="#000000" stroke-width="0" stroke-opacity="1"></use>
    </g>
  </g>
</g>
</svg>

</div>
<!-- draggables -->
<!--
-->
<!--  -->
<div id="zonas_linguisticas">

  <!-- circulo -->
  <svg id="svg-circulo-drag" class="dragall" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  preserveAspectRatio="xMidYMid meet"
  viewBox="178.6385542168675 77.43373493975895 357.0120481927711 357.01204819277126" width="353.01" height="353.01">
  <defs>
    <path
    d="M532.65 254.94C532.65 352.36 453.56 431.45 356.14 431.45C258.73 431.45 179.64 352.36 179.64 254.94C179.64 157.52 258.73 78.43 356.14 78.43C453.56 78.43 532.65 157.52 532.65 254.94Z"
    id="circulo-drag"></path>
  </defs>
  <g>
    <g>
      <use xlink:href="#circulo-drag" opacity="1" width="150" height="150" fill-opacity="1"></use>
    </g>
  </g>
</svg>

<!-- cuadrado -->
<svg id="svg-cuadrado-drag" class="dragall" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
preserveAspectRatio="xMidYMid meet"
viewBox="111.1686746987952 78.63855421686739 387.13253012048193 383.51807228915663" width="383.13" height="379.52">
<defs>
  <path d="M112.17 79.64L495.3 79.64L495.3 459.16L112.17 459.16L112.17 79.64Z" id="cuadrado-drag"></path>
</defs>
<g>
  <g>
    <use xlink:href="#cuadrado-drag" opacity="1" fill="#1d5299" fill-opacity="1"></use>
    <g>
      <use xlink:href="#cuadrado-drag" opacity="1" fill-opacity="0" stroke="#6c40d2" stroke-width="0"
      stroke-opacity="1"></use>
    </g>
  </g>
</g>
</svg>
<!-- irregular -->
<svg id="svg-irregular-drag" class="dragall" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
preserveAspectRatio="xMidYMid meet"
viewBox="206.34939759036146 65.38554216867462 270.26506024096386 293.15662650602405" width="266.27" height="289.16">
<defs>
  <path d="M473.61 66.39L437.47 172.41L433.86 219.4L324.22 239.88L403.73 272.41L349.52 285.66L339.88 342.29L282.05 304.94L274.82 355.54L236.27 300.12L207.35 219.4L232.65 133.86L473.61 66.39Z" id="irregular-drag"></path>
</defs>
<g>
  <g>
    <use xlink:href="#irregular-drag" opacity="1" fill="#b06508" fill-opacity="1"></use>
    <g>
      <use xlink:href="#irregular-drag" opacity="1" fill-opacity="0" stroke="#000000" stroke-width="0"
      stroke-opacity="1"></use>
    </g>
  </g>
</g>
</svg>

<!-- triangulo -->

<svg id="svg-triangulo-drag" class="dragall" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
preserveAspectRatio="xMidYMid meet"
viewBox="179.84337349397592 85.86746987951798 249.78313253012053 294.3614457831326" width="245.78" height="290.36">
<defs>
  <path d="M426.63 374.82L180.84 377.23L300.12 86.87L426.63 374.82Z" id="triangulo-drag"></path>
</defs>
<g>
  <g>
    <use xlink:href="#triangulo-drag" opacity="1" fill="#469216" fill-opacity="1"></use>
    <g>
      <use xlink:href="#triangulo-drag" opacity="1" fill-opacity="0" stroke="#000000" stroke-width="0" stroke-opacity="1"></use>
    </g>
  </g>
</g>
</svg>

</div>

</body>

<script>
//
const colorObj = '#0169B1';
const colorObjDropped = '#8BBE42';
const colorArea = '#86378B';
const colorAreaActive = '#D63A87';
(//ready
  function($) {

    // posicion inicial arrastrables
    // let initpos = document.querySelectorAll('.dragall')
    // initpos.forEach(item=>{
    //   item.style.webkitTransform =
    //   item.style.transform =
    //   'translate(50%, 50%)'
    // })
    // color inicial a contenedores
    let colorea = document.querySelectorAll('.dropall')
    colorea.forEach(item=>{
      item.querySelector('path').style.fill = colorArea
    })

    // inicializa todos los arrastrables
    Drag()

    // instancias
    configurarDrop("#svg-triangulo-area", "#svg-triangulo-drag" )
    configurarDrop("#svg-circulo-area", "#svg-circulo-drag" )
    configurarDrop("#svg-cuadrado-area", "#svg-cuadrado-drag" )
    configurarDrop("#svg-irregular-area", "#svg-irregular-drag" )


  }()
)//fin ready

function Drag() {
  // drag
  interact('.dragall')
  .draggable({
    inertia: true,
    modifiers: [
      interact.modifiers.restrictRect({
        restriction: 'body',
        endOnly: true,
      })
    ],
    // autoScroll: true,
    onmove: dragMoveListener,
    onend: (event) => {
      event.target.querySelector('path').style.fill = colorObj

    }
  })
}

function dragMoveListener(event) {

  let target = event.target//svg
  let targetPath = document.querySelector('#' + target.id).querySelector('path')

  // aplica los valores en los atributos data-
  var x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx
  var y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy
  // translate the element
  target.style.webkitTransform =
  target.style.transform =
  'translate(' + x + 'px, ' + y + 'px)'

  // update the posiion attributes
  target.setAttribute('data-x', x)
  target.setAttribute('data-y', y)
}

function configurarDrop(interactObj, acceptObj) {

  const obj = document.querySelector(acceptObj)
  const pathObj = document.querySelector(acceptObj).querySelector('path')
  const contObj = document.querySelector(interactObj)

  pathObj.style.fill = colorObj
  interact(interactObj).dropzone({
    accept: acceptObj,
    // Requiere el 15% del elemento para ejercer el 'drop'
    overlap: 0.15,
    // Eventos relacionados al 'drop':
    ondropactivate: (event) => {
      event.target.querySelector('path').style.fill = colorAreaActive
      event.relatedTarget.querySelector('path').style.fill = colorAreaActive
    },
    //al entrar en zona de 'drop'
    ondragenter: (event) => {
      event.target.querySelector('path').style.fill = colorObjDropped
    },
    //al soltarlo dentro de la zona de 'drop'
    ondrop: (event) => {
      let dropzone = event.target.getBoundingClientRect()
      pathObj.style.fill = 'gray'
      // snap
      obj.style.webkitTransform =
      obj.style.transform =
      'translate(' + dropzone.left + 'px, ' + dropzone.top    + 'px)'

    },
    //Al salir del 'dropzone'
    ondragleave: (event) => {
      event.target.querySelector('path').style.fill = colorAreaActive
    },
    // Al dejar fuera de la zona de 'drop'
    ondropdeactivate: (event) => {
      event.target.querySelector('path').style.fill = colorArea
    }
  })
}

</script>
</html>
